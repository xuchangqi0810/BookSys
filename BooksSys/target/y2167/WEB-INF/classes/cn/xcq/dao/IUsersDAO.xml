<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--namespace:接口绝对路径-->
<mapper namespace="cn.xcq.dao.IUsersDAO">

    <!--<resultMap id="Question" type="cn.xcq.entity.Questions">
        <id column="id" property="id"/>
        <result column="title" property="title"/>
        <result column="detailDesc" property="detailDesc"/>
        <result column="answerCount" property="answerCount"/>
        <result column="lastModified" property="lastModified"/>
        <result column="lastModified" property="lastModified"/>
        <collection  property="answerss"  ofType="Answers" select="getAllAnsContent" column="id"></collection>
    </resultMap>-->

    <select id="login" resultType="Users">
        SELECT * FROM users WHERE user_code=#{0} AND `password`=#{1}
    </select>

    <insert id="registerUser">
            INSERT INTO users(user_id,user_code,password,email,gender,register_time,last_logintime)VALUES(DEFAULT,#{user_code},#{password},#{email},#{gender},#{register_time},#{last_logintime})
    </insert>

    <select id="getBook_Type" resultType="Book_Type">
        SELECT * FROM book_type
    </select>

    <!--所有图书-->
    <select id="getAllBook" resultType="Book_Info">
        SELECT a.*,b.type_name FROM book_info a,book_type b WHERE a.book_type=b.id

            <if test="typeId!=0">
                AND book_type=#{typeId}
            </if>
            <if test="bookName!=null and bookName !=''">
                AND book_name LIKE '%' #{bookName} '%'
            </if>
            <if test="is_borrow!=0">
                AND is_borrow=#{is_borrow}
            </if>
         limit #{pageIndex},#{pageSize}
    </select>

    <!--所有记录数-->
    <select id="getCount" resultType="int">
        SELECT count(1) FROM book_info
        <where>
            <if test="typeId!=0">
                AND book_type=#{typeId}
            </if>
            <if test="bookName!=null">
                AND book_name LIKE '%' #{bookName} '%'
            </if>
            <if test="is_borrow!=0">
                AND is_borrow=#{is_borrow}
            </if>
        </where>
    </select>

</mapper>
